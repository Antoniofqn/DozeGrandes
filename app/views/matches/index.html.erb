<h1>Escolha o confronto</h1>

<div class="container" data-controller="club-click">
  <div class="container clubs">
      <% Club.all.each do |club| %>
        <%= cl_image_tag club.photo.key, height: 100, width: 100, id: club.name, class: "club", data: {action: "click->club-click#fill", target: 'club'} %>
      <% end  %>
  </div>

  <div class="container col-6 form mt-3">
    <%= simple_form_for :search, url: root_path, method: "GET", html: { class: 'form-group' } do |f| %>
    <div class="row">
      <div class="col-3">
        <%= f.input :home, input_html: {value: "#{@home.name unless @home.nil?}",  'data-club-click-target': 'home'}, readonly: true, label: false %>
      </div>
      <div class="col-3" id="x">
        <p>X</p>
      </div>
      <div class="col-3">
        <%= f.input :away, input_html: {value: "#{@away.name unless @away.nil?}", 'data-club-click-target': 'away'}, readonly: true, label: false%>
      </div>
    </div>
        <% if params['search'].present?  %>
          <%= f.input :competition, collection: @competitions %>
          <%= f.input :stadium, collection: @stadiums %>
          <%= f.input :start_date, as: :date, discard_day: true, discard_month: true, start_year: Date.today.year - 120, end_year: Date.today.year, prompt: "Select an option" %>
          <%= f.input :end_date, as: :date, discard_day: true, discard_month: true, start_year: Date.today.year - 120, end_year: Date.today.year, prompt: "Select an option" %>
        <% end %>
      <%= f.submit "Search", class: "btn btn-primary" %>
    <% end %>
  </div>
</div>

<div class="container graphs">
  <% if params['search'].present? %>
    <div>
      <h3>Resultados</h3>
      <%= pie_chart @matches.group(:result).count %>
    </div>
    <div>
      <h3>Gols</h3>
      <%= pie_chart ({ @home.name => @home.total_goals(@matches), @away.name => @away.total_goals(@matches) }) %>
    </div>
  <% end %>
</div>

<div class="container">
  <table class="table table-bordered table-sm">
    <thead class="thead-dark">
      <tr>
        <th scope="col">Data</th>
        <th scope="col">Mandante</th>
        <th scope="col">Resultado</th>
        <th scope="col">Visitante</th>
        <th scope="col">Estádio</th>
        <th scope="col">Competição</th>
      </tr>
    </thead>
      <% if params['search'].present? %>
        <% @matches.order('date desc').each do |match| %>
          <tr>
            <td scope="row"><%= match.date %></td>
            <td><%= match.home.name %></td>
            <td><%= match.score_home %> x <%= match.score_away %></td>
            <td><%= match.away.name %></td>
            <td><%= match.stadium %></td>
            <td><%= match.competition %></td>
          </tr>
        <% end %>
      <% end %>
  </table>
</div>
